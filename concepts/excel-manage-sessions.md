---
title: Administrar sesiones y persistencia Excel con Microsoft Graph
description: Si la aplicación necesita hacer más de una o dos llamadas a la API de Excel, debería crear una sesión y pasar el identificador de sesión con cada solicitud. La presencia de un identificador de sesión en las solicitudes asegura que usa la API de Excel de la manera más eficiente posible.
localization_priority: Normal
author: lumine2008
ms.prod: excel
ms.openlocfilehash: 151119a2a2861b64db126c8f49d0b916a6f563e8
ms.sourcegitcommit: 36be044c89a19af84c93e586e22200ec919e4c9f
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 01/12/2019
ms.locfileid: "27921692"
---
# <a name="manage-sessions-and-persistence-in-excel-with-microsoft-graph"></a><span data-ttu-id="4f81a-104">Administrar sesiones y persistencia Excel con Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="4f81a-104">Manage sessions and persistence in Excel with Microsoft Graph</span></span>

<span data-ttu-id="4f81a-105">Si la aplicación necesita hacer más de una o dos llamadas a la API de Excel, debería crear una sesión y pasar el identificador de sesión con cada solicitud.</span><span class="sxs-lookup"><span data-stu-id="4f81a-105">If your application needs to make more than one or two calls to the Excel API, you should create a session and pass the session Id with each request.</span></span> <span data-ttu-id="4f81a-106">La presencia de un identificador de sesión en las solicitudes asegura que usa la API de Excel de la manera más eficiente posible.</span><span class="sxs-lookup"><span data-stu-id="4f81a-106">The presence of a session Id in the requests ensures that you are using the Excel API in the most efficient way possible.</span></span>

<span data-ttu-id="4f81a-107">Se puede llamar a las API de Excel de tres modos:</span><span class="sxs-lookup"><span data-stu-id="4f81a-107">Excel APIs are called in one of three modes:</span></span>

1. <span data-ttu-id="4f81a-108">**Sesión persistente** Todos los cambios realizados en el libro son persistentes (se guardan) en el libro.</span><span class="sxs-lookup"><span data-stu-id="4f81a-108">**Persistent session**  All changes made to the workbook are persisted (saved) to the workbook.</span></span> <span data-ttu-id="4f81a-109">Esta es la forma más eficaz y que ofrece un mejor rendimiento para usar la API de Excel.</span><span class="sxs-lookup"><span data-stu-id="4f81a-109">This is the most efficient and best-performing way to use the Excel API.</span></span>
2. <span data-ttu-id="4f81a-110">**Sesión no persistente** Los cambios realizados por la API no se guardan en la ubicación de origen.</span><span class="sxs-lookup"><span data-stu-id="4f81a-110">**Non-persistent session**  Changes made by the API are not saved to the source location.</span></span> <span data-ttu-id="4f81a-111">En su lugar, el servidor backend de Excel conserva una copia temporal del archivo que refleja los cambios realizados durante esa sesión API en concreto.</span><span class="sxs-lookup"><span data-stu-id="4f81a-111">Instead, the Excel backend server keeps a temporary copy of the file that reflects the changes made during that particular API session.</span></span> <span data-ttu-id="4f81a-112">Cuando expira la sesión de Excel, se pierden los cambios.</span><span class="sxs-lookup"><span data-stu-id="4f81a-112">When the Excel session expires, the changes are lost.</span></span> <span data-ttu-id="4f81a-113">Este modo es útil para aplicaciones que necesitan realizar análisis u obtener los resultados de un cálculo de una imagen de gráfico, pero no necesitan afectar al estado de documento.</span><span class="sxs-lookup"><span data-stu-id="4f81a-113">This mode is useful for apps that need to do analysis or obtain the results of a calculation or a chart image, but do not need to affect the document state.</span></span>
3. <span data-ttu-id="4f81a-114">**Sin sesión** Las llamadas a la API no pasan un identificador de sesión. Los servidores de Excel deben buscar la copia del servidor del libro para cada operación.</span><span class="sxs-lookup"><span data-stu-id="4f81a-114">**Sessionless**  The API calls do not pass a session Id. The Excel servers have to locate the server's copy of the workbook for each operation.</span></span> <span data-ttu-id="4f81a-115">No es una forma eficaz para llamar a la API de Excel, pero es adecuada para hacer ciertos tipos de solicitudes aisladas.</span><span class="sxs-lookup"><span data-stu-id="4f81a-115">This is not an efficient way to call the Excel API, but it is suitable for making certain types of isolated requests.</span></span>

<span data-ttu-id="4f81a-116">Para representar la sesión en la API, utilice el encabezado `workbook-session-id: {session-id}`.</span><span class="sxs-lookup"><span data-stu-id="4f81a-116">To represent the session in the API, use the `workbook-session-id: {session-id}` header.</span></span>

><span data-ttu-id="4f81a-p106">**Nota:** El encabezado de sesión no es necesario para que funcione una API de Excel. Sin embargo, recomendamos que utilice el encabezado de sesión para mejorar el rendimiento. Si no utiliza un encabezado de sesión, los cambios realizados durante la llamada API _sí_ persisten en el archivo.</span><span class="sxs-lookup"><span data-stu-id="4f81a-p106">**Note:** The session header is not required for an Excel API to work. However, we recommend that you use the session header to improve performance. If you don't use a session header, changes made during the API call _are_ persisted to the file.</span></span>  

## <a name="next-step"></a><span data-ttu-id="4f81a-120">Paso siguiente</span><span class="sxs-lookup"><span data-stu-id="4f81a-120">Next step</span></span>
<span data-ttu-id="4f81a-121">Para obtener información sobre cómo crear y usar sesiones, consulte el [tema de referencia sobre creación de sesiones](/graph/api/workbook-createsession?view=graph-rest-1.0).</span><span class="sxs-lookup"><span data-stu-id="4f81a-121">To learn how to create and use sessions, see the [Create session reference topic](/graph/api/workbook-createsession?view=graph-rest-1.0).</span></span>

## <a name="see-also"></a><span data-ttu-id="4f81a-122">Vea también</span><span class="sxs-lookup"><span data-stu-id="4f81a-122">See also</span></span>
* [<span data-ttu-id="4f81a-123">Escribir en un libro de Excel con Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="4f81a-123">Write to an Excel workbook using Microsoft Graph</span></span>](excel-write-to-workbook.md)
* [<span data-ttu-id="4f81a-124">Usar funciones de libro en Excel con Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="4f81a-124">Use workbook functions in Excel with Microsoft Graph</span></span>](excel-use-functions.md)
* [<span data-ttu-id="4f81a-125">Actualizar el formato de un rango en Excel con Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="4f81a-125">Update a range’s format in Excel with Microsoft Graph</span></span>](excel-update-range-format.md)
* [<span data-ttu-id="4f81a-126">Mostrar una imagen de gráfico de Excel con Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="4f81a-126">Display a chart image in Excel with Microsoft Graph</span></span>](excel-display-chart-image.md)
* [<span data-ttu-id="4f81a-127">Usar la API de REST de Excel</span><span class="sxs-lookup"><span data-stu-id="4f81a-127">Use the Excel REST API</span></span>](/graph/api/resources/excel?view=graph-rest-1.0)
